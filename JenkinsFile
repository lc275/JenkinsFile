你的问题是 "更多" 按钮展开后，点击页面其他地方也能收起菜单。
现在的代码可能因为 事件冒泡 或 变量作用域问题 导致收起失败。

完整修正代码

async function loadNavbar() {
    // 读取工具列表
    const response = await fetch("tools.js");
    const tools = await response.json();

    const mainToolsContainer = document.getElementById("main-tools");
    const moreToolsContainer = document.getElementById("more-tools");
    const moreBtn = document.getElementById("more-btn");
    const moreDropdown = document.getElementById("more-dropdown");

    // 显示前 5 个工具
    tools.slice(0, 5).forEach(tool => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${tool.url}">${tool.name}</a>`;
        mainToolsContainer.appendChild(li);
    });

    // 剩余的工具放入 "更多"
    tools.slice(5).forEach(tool => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${tool.url}">${tool.name}</a>`;
        moreToolsContainer.appendChild(li);
    });

    // 初始隐藏菜单
    moreToolsContainer.style.display = "none";

    // 绑定点击事件，展开/收回
    moreBtn.addEventListener("click", (event) => {
        event.stopPropagation(); // 阻止事件冒泡，防止触发 document 监听
        if (moreToolsContainer.style.display === "none") {
            moreToolsContainer.style.display = "block";
        } else {
            moreToolsContainer.style.display = "none";
        }
    });

    // 点击页面其他地方时，自动收起
    document.addEventListener("click", (event) => {
        if (!moreDropdown.contains(event.target)) {
            moreToolsContainer.style.display = "none";
        }
    });
}

// 自动加载导航栏
document.addEventListener("DOMContentLoaded", async () => {
    const navContainer = document.createElement("div");
    document.body.insertBefore(navContainer, document.body.firstChild);
    
    // 加载导航栏 HTML
    const response = await fetch("nav.html");
    navContainer.innerHTML = await response.text();
    
    // 加载导航栏工具
    loadNavbar();
});


---

修正点

1. event.stopPropagation()：防止点击 "更多" 按钮时触发 document.click 事件，从而误收起菜单。


2. document.addEventListener("click")：判断 点击的是否是 moreDropdown 内部，如果不是，则收起菜单。


3. 确保 moreToolsContainer.style.display = "none" 作为初始状态，防止页面加载时菜单默认展开。




---

最终效果

✔ 点击 "更多" 按钮 → 菜单展开
✔ 再次点击 "更多" 按钮 → 菜单收回
✔ 点击页面其他地方 → 菜单自动收回

这样，"更多" 按钮的展开/收回效果完全符合你的需求了！

